---
title: "Team 5 Modeling"
author: "Matt Ammirati"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
library(tidyverse)
library(readr)
library(caret)
library(rsample)
```

```{r}
df <- read_csv('Team5Data.csv')
glimpse(df)
```
```{r}
unique(df$treatment_outcome)
```

```{r}
table(df$treatment_outcome, useNA = "ifany")
```
```{r}
table(df$trial_arm, useNA = 'ifany')
```
```{r}
df_new_target <- df %>%
  filter(trial_arm == "mrna-4157 + keytruda") %>%
  mutate(outcome_favorable = case_when (
    treatment_outcome %in% c("Complete Response", "Partial Response") ~ "Favorable",
    treatment_outcome %in% c("Stable Disease", "Progression") ~ "Unfavorable",
    TRUE ~ NA_character_
  )) %>%
  
  filter(!is.na(outcome_favorable)) %>%
  
  mutate(outcome_favorable = factor(outcome_favorable))
```
```{r}
table(df_new_target$outcome_favorable)
prop.table(table(df_new_target$outcome_favorable))
```
Ok now that we have the target variable and there is no imbalance, lets move on

```{r}
df_new_target %>% 
  summarise(across(everything(), ~sum(is.na(.)))) %>%
  pivot_longer(cols = everything(), names_to = "variable", values_to = "missing_count") %>%
  filter(missing_count > 0) %>%
  arrange(desc(missing_count))
```
```{r}
df_new_target %>%
  select(where(is.numeric)) %>%
  pivot_longer(cols = everything(), names_to = "predictor", values_to = "value") %>%
  ggplot(aes(x = value)) +
  geom_histogram(bins = 30, fill = "blue", color = "white") +
  facet_wrap(~ predictor, scales = "free", ncol = 3) +
  labs(title = "Distribution of Numeric Predictors", x = "Value", y = "Count")

```







